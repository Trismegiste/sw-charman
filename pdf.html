<!DOCTYPE html>
<html>
    <head>
        <title>Nephilim Savage Worlds edition Character Manager</title>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </head>
    <body>
        <script src="./js/riot+compiler.min.js"></script>

        <script src="./js/Character.js"></script>
        <script src="./js/Repository.js"></script>
        <script src="./js/Model.js"></script>
        <script src="./js/NephilimRendering.js"></script>
        <script src="./js/dexie.min.js"></script>
        <script src="./js/pdf/pdfmake.min.js"></script>
        <script src="./js/pdf/vfs_fonts.js"></script>
        <script>
            // container for this SPA
            var SwCharman = {
                repository: new Repository(),
                model: new Model()
            }
            // Here we go
            riot.route.start(true);
            var q = riot.route.query()

            SwCharman.repository.findByPk(q.key)
                    .then(function (character) {

                        var docDefinition = new NephilimRendering(character);
                        //pdfMake.createPdf(docDefinition.getDocument()).download(character.type + '-' + character.name + '.pdf');
                        pdfMake.createPdf(docDefinition.getDocument()).open()
                        setTimeout("window.close()", 5000)
                    })
        </script>
    </body>
</html>
